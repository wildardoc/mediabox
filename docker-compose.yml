##
## -------------------------
## |   M E D I A B O X     |
## -------------------------
##
## Container based media tools configuration
##
## -- DO NOT EDIT THIS FILE --
##
##  Please edit 'env-example' for configuration.
##
##  When finished editing 'env-example' copy 'env-example' to '.env'
##   $ cp env-example .env
##
##  Have docker-compose.yml and .env in the same directory to launch the stack

version: '2'

######################
# SERVICES TO LAUNCH #
######################

services:

    # ----------------------------------------
    # Couchpotato
    # ----------------------------------------
    couchpotato:
        image: linuxserver/couchpotato
        restart: always
        container_name: couchpotato
        ports:
            - '${IP_ADDRESS}:5050:5050'
        volumes:
            - './couchpotato:/config'
            - './delugevpn/data/complete:/downloads'
            - './movies:/movies'
            - '/etc/localtime:/etc/localtime:ro'
        environment:
            - PUID=${PUID}
            - PGID=${PGID}
    
    # ----------------------------------------
    # DELUGEVPN
    # ----------------------------------------
    arch-delugevpn:
        image: binhex/arch-delugevpn
        ports:
            - '${IP_ADDRESS}:8112:8112'
            - '${IP_ADDRESS}:8118:8118'
            - '${IP_ADDRESS}:58846:58846'
        container_name: delugevpn
        restart: always
        cap_add:
            - NET_ADMIN
        volumes:
            - './delugevpn/data:/data'
            - './delugevpn/data/downloading:/data'
            - './delugevpn/config:/config'
            - '/etc/localtime:/etc/localtime:ro'
        environment:
            - VPN_ENABLED=yes
            - VPN_USER=${PIAUNAME}
            - VPN_PASS=${PIAPASS}
            - VPN_REMOTE=us-east.privateinternetaccess.com
            - VPN_PORT=1198
            - VPN_PROTOCOL=udp
            - VPN_PROV=pia
            - STRONG_CERTS=no
            - ENABLE_PRIVOXY=yes
            - LAN_NETWORK=${CIDR_ADDRESS}
            - 'NAME_SERVERS=8.8.8.8,8.8.4.4'
            - DEBUG=false
            - PUID=${PUID}
            - PGID=${PGID}
      
    # ----------------------------------------
    # PLEX
    # ----------------------------------------
    plex:
        image: linuxserver/plex
        restart: always
        container_name: plex
        network_mode: "host"
        environment:
            - VERSION=latest
            - PUID=${PUID}
            - PGID=${PGID}
        volumes:
            - './plex:/config'
            - './tv:/data/tvshows'
            - './movies:/data/movies'
            - '/etc/localtime:/etc/localtime:ro'
      
    # ----------------------------------------
    # PORTAINER
    # ----------------------------------------
    portainer:
        image: portainer/portainer
        ports:
            - '${IP_ADDRESS}:9000:9000'
        container_name: portainer
        restart: always
        volumes:
            - '/var/run/docker.sock:/var/run/docker.sock'
            - '/etc/localtime:/etc/localtime:ro'
    
    # ----------------------------------------
    # SICKRAGE
    # ----------------------------------------
    sickrage:
        image: linuxserver/sickrage
        container_name: sickrage
        volumes:
            - './sickrage:/config'
            - './delugevpn/data/complete:/downloads'
            - './tv:/tv'
            - '/etc/localtime:/etc/localtime:ro'
        environment:
            - PUID=${PUID}
            - PGID=${PGID}
        restart: always
        ports:
            - '${IP_ADDRESS}:8081:8081'
